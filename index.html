<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plataforma Pro - Mobile</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
html, body { width:100%; height:100%; overflow:hidden; background:#87CEEB; font-family:'Arial',sans-serif; }
canvas { display:block; background:linear-gradient(to top,#87CEEB,#B0E0E6); }
#controls { position:absolute; bottom:10px; width:100%; text-align:center; z-index:10; }
.btn { background:rgba(0,0,0,0.6); color:white; font-size:28px; border:none; padding:15px 25px; margin:5px; border-radius:12px; cursor:pointer; touch-action:manipulation; }
.btn:active { background: rgba(0,0,0,0.8); }
</style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<div id="controls">
<button class="btn" id="leftBtn">⏪</button>
<button class="btn" id="jumpBtn">⏫</button>
<button class="btn" id="rightBtn">⏩</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let groundLevel;
function resizeCanvas(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    groundLevel = canvas.height - 100;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// Controles
let keys = {left:false,right:false,up:false};
const buttons = {left:"leftBtn",right:"rightBtn",up:"jumpBtn"};
Object.keys(buttons).forEach(k=>{
    const el=document.getElementById(buttons[k]);
    el.addEventListener("touchstart", e=>{ e.preventDefault(); keys[k]=true; });
    el.addEventListener("touchend", e=>{ e.preventDefault(); keys[k]=false; });
});
document.addEventListener("keydown", e=>{
    if(e.key==="ArrowLeft") keys.left=true;
    if(e.key==="ArrowRight") keys.right=true;
    if(e.key==="ArrowUp"||e.key===" ") keys.up=true;
    if(e.key==="Enter" && gameOver) resetGame();
});
document.addEventListener("keyup", e=>{
    if(e.key==="ArrowLeft") keys.left=false;
    if(e.key==="ArrowRight") keys.right=false;
    if(e.key==="ArrowUp"||e.key===" ") keys.up=false;
});

let cameraX=0;
let gameOver=false;

// CLASSES
class Player{
    constructor(){
        this.w=50; this.h=70;
        this.x=200; this.y=groundLevel-this.h;
        this.velY=0; this.speed=6;
        this.lives=3; this.score=0;
        this.onGround=true; this.frame=0;
    }
    update(){
        if(keys.left) this.x-=this.speed;
        if(keys.right) this.x+=this.speed;

        this.velY+=0.8;
        this.y+=this.velY;

        if(this.y+this.h>=groundLevel){
            this.y=groundLevel-this.h;
            this.velY=0;
            this.onGround=true;
        }

        if(keys.up && this.onGround){
            this.velY=-16;
            this.onGround=false;
        }

        if(keys.left||keys.right){ this.frame+=0.2; if(this.frame>3) this.frame=0; } else this.frame=0;
    }
    draw(){
        // corpo
        ctx.fillStyle="#1E90FF";
        ctx.fillRect(this.x-cameraX,this.y,this.w,this.h);
        // cabeça
        ctx.fillStyle="#FFD700";
        ctx.beginPath();
        ctx.arc(this.x-cameraX+this.w/2,this.y-15,15,0,Math.PI*2);
        ctx.fill();
        // braços animados
        ctx.strokeStyle="#000"; ctx.lineWidth=4; ctx.beginPath();
        let armOffset=Math.sin(this.frame*Math.PI)*12;
        ctx.moveTo(this.x-cameraX,this.y+15);
        ctx.lineTo(this.x-cameraX-12,this.y+25+armOffset);
        ctx.moveTo(this.x-cameraX+this.w,this.y+15);
        ctx.lineTo(this.x-cameraX+this.w+12,this.y+25-armOffset);
        ctx.stroke();
        // pernas animadas
        ctx.beginPath();
        let legOffset=Math.sin(this.frame*Math.PI)*12;
        ctx.moveTo(this.x-cameraX+10,this.y+this.h);
        ctx.lineTo(this.x-cameraX+10,this.y+this.h+20+legOffset);
        ctx.moveTo(this.x-cameraX+this.w-10,this.y+this.h);
        ctx.lineTo(this.x-cameraX+this.w-10,this.y+this.h+20-legOffset);
        ctx.stroke();
    }
}

class Enemy{
    constructor(x){
        this.x=x; this.y=groundLevel-40; this.size=40;
        this.speed=2; this.direction=-1; this.alive=true; this.frame=0;
    }
    update(){
        this.x+=this.speed*this.direction;
        if(this.x<cameraX-120) this.direction=1;
        if(this.x>cameraX+canvas.width+120) this.direction=-1;
        this.frame+=0.1; if(this.frame>3) this.frame=0;
    }
    draw(){
        if(!this.alive) return;
        ctx.fillStyle="#FF4500"; ctx.fillRect(this.x-cameraX,this.y,this.size,this.size);
        ctx.strokeStyle="#000"; ctx.lineWidth=3; ctx.beginPath();
        let legOffset=Math.sin(this.frame*Math.PI)*8;
        ctx.moveTo(this.x-cameraX+8,this.y+this.size);
        ctx.lineTo(this.x-cameraX+8,this.y+this.size+15+legOffset);
        ctx.moveTo(this.x-cameraX+this.size-8,this.y+this.size);
        ctx.lineTo(this.x-cameraX+this.size-8,this.y+this.size+15-legOffset);
        ctx.stroke();
    }
}

class Cloud{
    constructor(x,y,speed,size){ this.x=x; this.y=y; this.speed=speed; this.size=size; }
    update(){ this.x-=this.speed; if(this.x+this.size<cameraX) this.x=cameraX+canvas.width+200; }
    draw(){ ctx.fillStyle="#fff"; ctx.beginPath(); ctx.arc(this.x-cameraX,this.y,this.size/2,0,Math.PI*2); ctx.fill(); }
}

// OBJETOS
let player=new Player();
let enemies=[new Enemy(900), new Enemy(1500)];
let clouds=[new Cloud(250,100,0.3,100), new Cloud(600,150,0.5,80), new Cloud(1200,70,0.2,120)];

function spawnEnemy(){ enemies.push(new Enemy(cameraX+canvas.width+Math.random()*600+200)); }
function checkCollision(p,e){ return p.x<e.x+e.size && p.x+p.w>e.x && p.y<e.y+e.size && p.y+p.h>e.y; }
function handleCollisions(){
    enemies.forEach(enemy=>{
        if(enemy.alive && checkCollision(player,enemy)){
            if(player.velY>0 && player.y+player.h-player.velY<enemy.y){
                enemy.alive=false; player.velY=-12; player.score++;
                if(player.score%3===0) spawnEnemy();
            } else { player.lives--; enemy.alive=false; if(player.lives<=0) gameOver=true; }
        }
    });
}
function drawHUD(){
    ctx.fillStyle="#000"; ctx.font="22px Arial";
    ctx.fillText(`Vidas: ${player.lives}`,20,35);
    ctx.fillText(`Pontos: ${player.score}`,20,65);
}
function drawGameOver(){
    ctx.fillStyle="rgba(0,0,0,0.7)"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="white"; ctx.font="50px Arial";
    ctx.fillText("GAME OVER",canvas.width/2-150,canvas.height/2-50);
    ctx.font="28px Arial"; ctx.fillText("Toque ou Enter para reiniciar",canvas.width/2-200,canvas.height/2+20);
}
function resetGame(){ player=new Player(); enemies=[new Enemy(900),new Enemy(1500)]; gameOver=false; }

canvas.addEventListener("touchstart", ()=>{ if(gameOver) resetGame(); });

function gameLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#6BB7FF"; ctx.fillRect(0,0,canvas.width,groundLevel);
    clouds.forEach(c=>{c.update();c.draw();});
    ctx.fillStyle="#228B22"; ctx.fillRect(0,groundLevel,canvas.width,canvas.height-groundLevel);

    if(!gameOver){
        player.update();
        enemies.forEach(e=>e.update());
        handleCollisions();
        player.draw();
        enemies.forEach(e=>e.draw());
        drawHUD();
        enemies.forEach(e=>e.speed=2+player.score*0.2);
        cameraX=player.x-200;
    } else drawGameOver();

    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
